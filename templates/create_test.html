<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç - Qabylda</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: #f8fafc; }
        .container { max-width: 800px; margin: 0 auto; padding: 40px 20px; }
        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { color: #1DB584; font-size: 2rem; margin-bottom: 10px; }
        .form-card { background: white; border-radius: 15px; padding: 40px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 25px; }
        .form-label { display: block; font-weight: 600; color: #2C3E50; margin-bottom: 8px; }
        .form-select, .form-input { width: 100%; padding: 12px 16px; border: 2px solid #E8F4F8; border-radius: 8px; font-size: 16px; }
        .form-select:focus, .form-input:focus { outline: none; border-color: #1DB584; }
        .tech-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px; }
        .tech-item { display: flex; align-items: center; gap: 8px; padding: 10px; background: #f8f9fa; border-radius: 6px; }
        .tech-checkbox { width: 18px; height: 18px; }
        .btn-primary { background: #1DB584; color: white; padding: 15px 30px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; width: 100%; }
        .btn-primary:hover { background: #159A73; }
        .section-title { font-size: 1.2rem; color: #2C3E50; margin: 30px 0 15px 0; border-bottom: 2px solid #1DB584; padding-bottom: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Å—Ç</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ IT-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤</p>
        </div>

        <div class="form-card">
            <form id="createTestForm">
                <!-- –î–∞–Ω–Ω—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ -->
                <div class="section-title">üë§ –î–∞–Ω–Ω—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞</div>
                
                <div class="form-group">
                    <label class="form-label">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞</label>
                    <input type="text" class="form-input" id="candidateName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Email –∫–∞–Ω–¥–∏–¥–∞—Ç–∞</label>
                    <input type="email" class="form-input" id="candidateEmail" required>
                </div>

                <!-- –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ —É—Ä–æ–≤–µ–Ω—å -->
                <div class="section-title">üíº –ü–æ–∑–∏—Ü–∏—è</div>

                <div class="form-group">
                    <label class="form-label">–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</label>
                    <select class="form-select" id="position" onchange="updateSpecializations()">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</option>
                        <option value="Data Scientist">Data Scientist</option>
                        <option value="Data Analyst">Data Analyst</option>
                        <option value="HR Specialist">HR Specialist</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</label>
                    <select class="form-select" id="specialization">
                        <option value="">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">–£—Ä–æ–≤–µ–Ω—å</label>
                    <select class="form-select" id="level">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å</option>
                        <option value="junior">Junior</option>
                        <option value="middle">Middle</option>
                        <option value="senior">Senior</option>
                    </select>
                </div>

                <!-- –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ -->
                <div class="section-title">üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</div>
                
                <div class="form-group">
                    <label class="form-label">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (–Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å)</label>
                    <div class="tech-grid" id="requiredTech">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (–±–æ–Ω—É—Å–Ω—ã–µ)</label>
                    <div class="tech-grid" id="optionalTech">
                        <!-- –ó–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>

                <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è -->
                <div class="section-title">üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</div>

                <div class="form-group">
                    <label class="form-label">–û—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                    <textarea class="form-input" id="customRequirements" rows="3" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏..."></textarea>
                </div>

                <button type="submit" class="btn-primary">
                    üöÄ –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç
                </button>
            </form>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–π
        const specializations = {
            "Data Scientist": ["–û–±—â–∏–π", "Computer Vision", "NLP", "MLOps"],
            "Data Analyst": ["–û–±—â–∏–π", "Business Intelligence", "Marketing Analytics"],
            "HR Specialist": ["Generalist", "Recruiter", "L&D Specialist"]
        };

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –ò –∑–Ω–∞–Ω–∏–π
        const technologies = {
            "Data Scientist": {
                "–û–±—â–∏–π": {
                    required: ["Python", "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ", "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", "SQL", "Pandas/NumPy"],
                    optional: ["R", "TensorFlow", "PyTorch", "Scikit-learn", "Docker", "Git", "A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"]
                },
                "Computer Vision": {
                    required: ["Python", "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ", "–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ", "OpenCV", "PyTorch"],
                    optional: ["TensorFlow", "CUDA", "C++", "Docker", "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"]
                },
                "NLP": {
                    required: ["Python", "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ", "–û–±—Ä–∞–±–æ—Ç–∫–∞ —è–∑—ã–∫–∞", "NLTK", "Transformers"],
                    optional: ["spaCy", "PyTorch", "TensorFlow", "–õ–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞", "Docker", "Hugging Face"]
                },
                "MLOps": {
                    required: ["Python", "–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ", "DevOps", "Docker", "Git"],
                    optional: ["Kubernetes", "AWS/GCP", "MLflow", "Airflow", "CI/CD", "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π"]
                }
            },
            "Data Analyst": {
                "–û–±—â–∏–π": {
                    required: ["SQL", "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", "–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ –º—ã—à–ª–µ–Ω–∏–µ", "Excel", "–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö"],
                    optional: ["Python", "R", "Tableau", "Power BI", "Google Analytics", "A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ"]
                },
                "Business Intelligence": {
                    required: ["SQL", "–ë–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞", "Tableau/Power BI", "KPI –∏ –º–µ—Ç—Ä–∏–∫–∏", "–î–∞—à–±–æ—Ä–¥—ã"],
                    optional: ["Python", "DAX", "ETL –ø—Ä–æ—Ü–µ—Å—Å—ã", "Data Warehouse", "OLAP", "Reporting"]
                },
                "Marketing Analytics": {
                    required: ["SQL", "–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞", "Google Analytics", "Excel", "–ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏"],
                    optional: ["Python", "R", "Facebook Ads", "Yandex.Metrica", "CRM —Å–∏—Å—Ç–µ–º—ã", "–ö–æ–≥–æ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑"]
                }
            },
            "HR Specialist": {
                "Generalist": {
                    required: ["–¢—Ä—É–¥–æ–≤–æ–µ –ø—Ä–∞–≤–æ –†–ö", "HR –ø—Ä–æ—Ü–µ—Å—Å—ã", "–†–µ–∫—Ä—É—Ç–∏–Ω–≥", "–ú–æ—Ç–∏–≤–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞", "MS Office"],
                    optional: ["1C:–ó–£–ü", "SAP HR", "Workday", "Performance management", "HR –∞–Ω–∞–ª–∏—Ç–∏–∫–∞", "Change management"]
                },
                "Recruiter": {
                    required: ["–ú–µ—Ç–æ–¥—ã –ø–æ–¥–±–æ—Ä–∞", "–ò–Ω—Ç–µ—Ä–≤—å—é–∏—Ä–æ–≤–∞–Ω–∏–µ", "LinkedIn/HH.ru", "Sourcing", "Boolean search"],
                    optional: ["ATS —Å–∏—Å—Ç–µ–º—ã", "HR-–±—Ä–µ–Ω–¥–∏–Ω–≥", "Telegram –¥–ª—è —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥–∞", "Executive search", "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è"]
                },
                "L&D Specialist": {
                    required: ["–û–±—É—á–µ–Ω–∏–µ –≤–∑—Ä–æ—Å–ª—ã—Ö", "–ú–µ—Ç–æ–¥—ã –æ–±—É—á–µ–Ω–∏—è", "LMS —Å–∏—Å—Ç–µ–º—ã", "–û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏", "MS Office"],
                    optional: ["Instructional Design", "Moodle", "iSpring", "Articulate", "Zoom", "Gamification", "Mentoring"]
                }
            }
        };



        function updateSpecializations() {
            const position = document.getElementById('position').value;
            const specializationSelect = document.getElementById('specialization');
            
            specializationSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é</option>';
            
            if (position && specializations[position]) {
                specializations[position].forEach(spec => {
                    const option = document.createElement('option');
                    option.value = spec;
                    option.textContent = spec;
                    specializationSelect.appendChild(option);
                });
            }
            
            updateTechnologies();
        }

        function updateTechnologies() {
            const position = document.getElementById('position').value;
            const specialization = document.getElementById('specialization').value;
            
            const requiredDiv = document.getElementById('requiredTech');
            const optionalDiv = document.getElementById('optionalTech');
            
            requiredDiv.innerHTML = '';
            optionalDiv.innerHTML = '';
            
            if (position && specialization && technologies[position] && technologies[position][specialization]) {
                const tech = technologies[position][specialization];
                
                // –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                tech.required.forEach(techName => {
                    const div = document.createElement('div');
                    div.className = 'tech-item';
                    div.innerHTML = `
                        <input type="checkbox" class="tech-checkbox" checked disabled>
                        <span>${techName}</span>
                    `;
                    requiredDiv.appendChild(div);
                });
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                tech.optional.forEach(techName => {
                    const div = document.createElement('div');
                    div.className = 'tech-item';
                    div.innerHTML = `
                        <input type="checkbox" class="tech-checkbox" name="optionalTech" value="${techName}">
                        <span>${techName}</span>
                    `;
                    optionalDiv.appendChild(div);
                });
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        document.getElementById('createTestForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                candidate_name: document.getElementById('candidateName').value,
                candidate_email: document.getElementById('candidateEmail').value,
                position: document.getElementById('position').value,
                specialization: document.getElementById('specialization').value,
                level: document.getElementById('level').value,
                custom_requirements: document.getElementById('customRequirements').value,
                optional_technologies: Array.from(document.querySelectorAll('input[name="optionalTech"]:checked')).map(cb => cb.value)
            };
            
            try {
                const response = await fetch('/api/create-test', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    alert(`–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω! –ö–æ–¥: ${result.test_code}\n–°—Å—ã–ª–∫–∞: ${window.location.origin}/${result.test_code}`);
                    window.location.href = '/dashboard';
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + result.detail);
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ' + error.message);
            }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        document.getElementById('specialization').addEventListener('change', updateTechnologies);
    </script>
</body>
</html>